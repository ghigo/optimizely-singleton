!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=61)}([function(e,t){var r=Array.isArray;e.exports=r},function(e,t){t.LOG_LEVEL={NOTSET:0,DEBUG:1,INFO:2,WARNING:3,ERROR:4},t.ERROR_MESSAGES={INVALID_ATTRIBUTES:"%s: Provided attributes are in an invalid format.",INVALID_BUCKETING_ID:"%s: Unable to generate hash for bucketing ID %s: %s",INVALID_DATAFILE:"%s: Datafile is invalid - property %s: %s",INVALID_JSON:"%s: JSON object is not valid.",INVALID_ERROR_HANDLER:'%s: Provided "errorHandler" is in an invalid format.',INVALID_EVENT_DISPATCHER:'%s: Provided "eventDispatcher" is in an invalid format.',INVALID_EVENT_KEY:"%s: Event key %s is not in datafile.",INVALID_EVENT_TAGS:"%s: Provided event tags are in an invalid format.",INVALID_EXPERIMENT_KEY:"%s: Experiment key %s is not in datafile.",INVALID_EXPERIMENT_ID:"%s: Experiment ID %s is not in datafile.",INVALID_GROUP_ID:"%s: Group ID %s is not in datafile.",INVALID_LOGGER:'%s: Provided "logger" is in an invalid format.',INVALID_USER_ID:"%s: Provided user ID is in an invalid format.",INVALID_USER_PROFILE_SERVICE:"%s: Provided user profile service instance is in an invalid format: %s.",JSON_SCHEMA_EXPECTED:"%s: JSON schema expected.",NO_DATAFILE_SPECIFIED:"%s: No datafile specified. Cannot start optimizely.",NO_JSON_PROVIDED:"%s: No JSON object to validate against schema.",UNDEFINED_ATTRIBUTE:"%s: Provided attribute: %s has an undefined value.",USER_PROFILE_LOOKUP_ERROR:'%s: Error while looking up user profile for user ID "%s": %s.',USER_PROFILE_SAVE_ERROR:'%s: Error while saving user profile for user ID "%s": %s.'},t.LOG_MESSAGES={ACTIVATE_USER:"%s: Activating user %s in experiment %s.",DISPATCH_CONVERSION_EVENT:"%s: Dispatching conversion event to URL %s with params %s.",DISPATCH_IMPRESSION_EVENT:"%s: Dispatching impression event to URL %s with params %s.",DEPRECATED_EVENT_VALUE:"%s: Event value is deprecated in %s call.",EVENT_NOT_ASSOCIATED_WITH_EXPERIMENTS:"%s: Event %s is not associated with any running experiments.",EXPERIMENT_NOT_RUNNING:"%s: Experiment %s is not running.",FORCED_BUCKETING_FAILED:"%s: Variation key %s is not in datafile. Not activating user %s.",INVALID_OBJECT:"%s: Optimizely object is not valid. Failing %s.",INVALID_CLIENT_ENGINE:"%s: Invalid client engine passed: %s. Defaulting to node-sdk.",INVALID_VARIATION_ID:"%s: Bucketed into an invalid variation ID. Returning null.",NOT_ACTIVATING_USER:"%s: Not activating user %s for experiment %s.",NOT_TRACKING_USER:"%s: Not tracking user %s.",NOT_TRACKING_USER_FOR_EXPERIMENT:"%s: Not tracking user %s for experiment %s.",RETURNING_STORED_VARIATION:'%s: Returning previously activated variation "%s" of experiment "%s" for user "%s" from user profile.',SAVED_VARIATION:'%s: Saved variation "%s" of experiment "%s" for user "%s".',SAVED_VARIATION_NOT_FOUND:"%s: User %s was previously bucketed into variation with ID %s for experiment %s, but no matching variation was found.",SHOULD_NOT_DISPATCH_ACTIVATE:'%s: Experiment %s is in "Launched" state. Not activating user.',SHOULD_NOT_DISPATCH_TRACK:'%s: Experiment %s is in "Launched" state. Not tracking user for it.',SKIPPING_JSON_VALIDATION:"%s: Skipping JSON schema validation.",TRACK_EVENT:"%s: Tracking event %s for user %s.",USER_ASSIGNED_TO_VARIATION_BUCKET:"%s: Assigned variation bucket %s to user %s.",USER_ASSIGNED_TO_EXPERIMENT_BUCKET:"%s: Assigned experiment bucket %s to user %s.",USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is in experiment %s of group %s.",USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP:"%s: User %s is not in experiment %s of group %s.",USER_NOT_IN_EXPERIMENT:"%s: User %s is in no experiment.",USER_FORCED_IN_VARIATION:"%s: User %s is forced in variation %s.",USER_HAS_VARIATION:"%s: User %s is in variation %s of experiment %s.",USER_HAS_NO_VARIATION:"%s: User %s is in no variation of experiment %s.",USER_NOT_IN_ANY_EXPERIMENT:"%s: User %s is not in any experiment of group %s.",USER_NOT_IN_EXPERIMENT:"%s: User %s does not meet conditions to be in experiment %s.",VALID_DATAFILE:"%s: Datafile is valid.",VALID_USER_PROFILE_SERVICE:"%s: Valid user profile service provided."},t.JAVASCRIPT_CLIENT_ENGINE="javascript-sdk",t.NEW_OPTIMIZELY_VERSION="2",t.NODE_CLIENT_ENGINE="node-sdk",t.NODE_CLIENT_VERSION="1.3.0"},function(e,t,r){(function(t){var n=r(102),o=n("object"==typeof t&&t),i=n("object"==typeof self&&self),a=n("object"==typeof this&&this),s=o||i||a||Function("return this")();e.exports=s}).call(t,r(58))},function(e,t){var r=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var r=[];t>0;r[--t]=e);return r.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.object_stringify=function(e,t,r,o){var i="";if(null!=e)switch(typeof e){case"function":return"[Function"+(e.name?": "+e.name:"")+"]";case"object":if(e instanceof Error)return"["+e.toString()+"]";if(t>=r)return"[Object]";if(o&&(o=o.slice(0),o.push(e)),null!=e.length){i+="[";var a=[];for(var s in e)o&&o.indexOf(e[s])>=0?a.push("[Circular]"):a.push(n.object_stringify(e[s],t+1,r,o));i+=a.join(", ")+"]"}else{if("getMonth"in e)return"Date("+e+")";i+="{";var a=[];for(var u in e)e.hasOwnProperty(u)&&(o&&o.indexOf(e[u])>=0?a.push(u+": [Circular]"):a.push(u+": "+n.object_stringify(e[u],t+1,r,o)));i+=a.join(", ")+"}"}return i;case"string":return'"'+e+'"'}return""+e},n.format=function(o,i){var a,s,u,c,f,p,l,v=1,d=o.length,g="",E=[];for(s=0;s<d;s++)if("string"===(g=e(o[s])))E.push(o[s]);else if("array"===g){if(c=o[s],c[2])for(a=i[v],u=0;u<c[2].length;u++){if(!a.hasOwnProperty(c[2][u]))throw new Error(r('[sprintf] property "%s" does not exist',c[2][u]));a=a[c[2][u]]}else a=c[1]?i[c[1]]:i[v++];if(/[^sO]/.test(c[8])&&"number"!=e(a))throw new Error(r('[sprintf] expecting number but found %s "'+a+'"',e(a)));switch(c[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=c[7]?a.toExponential(c[7]):a.toExponential();break;case"f":a=c[7]?parseFloat(a).toFixed(c[7]):parseFloat(a);break;case"O":a=n.object_stringify(a,0,parseInt(c[7])||5);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&c[7]?a.substring(0,c[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(c[8])&&c[3]&&a>=0?"+"+a:a,p=c[4]?"0"==c[4]?"0":c[4].charAt(1):" ",l=c[6]-String(a).length,f=c[6]?t(p,l):"",E.push(c[5]?a+f:f+a)}return E.join("")},n.cache={},n.parse=function(e){for(var t=e,r=[],n=[],o=0;t;){if(null!==(r=/^[^\x25]+/.exec(t)))n.push(r[0]);else if(null!==(r=/^\x25{2}/.exec(t)))n.push("%");else{if(null===(r=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosOuxX])/.exec(t)))throw new Error("[sprintf] "+t);if(r[2]){o|=1;var i=[],a=r[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(a)))throw new Error("[sprintf] "+a);for(i.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(a)))i.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(a)))throw new Error("[sprintf] "+a);i.push(s[1])}r[2]=i}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push(r)}t=t.substring(r[0].length)}return n},n}(),n=function(e,t){var n=t.slice();return n.unshift(e),r.apply(null,n)};e.exports=r,r.sprintf=r,r.vsprintf=n},function(e,t){function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=r},function(e,t,r){function n(e){var t=c(e);if(!t&&!s(e))return i(e);var r=a(e),n=!!r,f=r||[],p=f.length;for(var l in e)!o(e,l)||n&&("length"==l||u(l,p))||t&&"constructor"==l||f.push(l);return f}var o=r(44),i=r(92),a=r(51),s=r(7),u=r(15),c=r(17);e.exports=n},function(e,t,r){e.exports={assignIn:r(154),isArray:r(0),cloneDeep:r(155),isEmpty:r(162),keyBy:r(164),filter:r(156),forEach:r(157),forOwn:r(33),map:r(166),reduce:r(169),values:r(177)}},function(e,t,r){function n(e){return null!=e&&a(o(e))&&!i(e)}var o=r(120),i=r(20),a=r(21);e.exports=n},function(e,t,r){function n(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?s(e)?i(e[0],e[1]):o(e):u(e)}var o=r(95),i=r(96),a=r(160),s=r(0),u=r(168);e.exports=n},function(e,t,r){function n(e,t){var r=i(e,t);return o(r)?r:void 0}var o=r(91),i=r(122);e.exports=n},function(e,t){function r(e){return!!e&&"object"==typeof e}e.exports=r},function(e,t,r){var n=r(42),o=r(115),i=o(n);e.exports=i},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var o=r(136),i=r(137),a=r(138),s=r(139),u=r(140);n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=a,n.prototype.has=s,n.prototype.set=u,e.exports=n},function(e,t,r){function n(e,t){for(var r=e.length;r--;)if(o(e[r][0],t))return r;return-1}var o=r(32);e.exports=n},function(e,t,r){function n(e,t){var r=e.__data__;return o(t)?r["string"==typeof t?"string":"hash"]:r.map}var o=r(133);e.exports=n},function(e,t){function r(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}var n=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=r},function(e,t,r){function n(e,t){if(o(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!i(e))||(s.test(e)||!a.test(e)||null!=t&&e in Object(t))}var o=r(0),i=r(22),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=n},function(e,t){function r(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}var n=Object.prototype;e.exports=r},function(e,t,r){var n=r(9),o=n(Object,"create");e.exports=o},function(e,t,r){function n(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}var o=r(22),i=1/0;e.exports=n},function(e,t,r){function n(e){var t=o(e)?u.call(e):"";return t==i||t==a}var o=r(4),i="[object Function]",a="[object GeneratorFunction]",s=Object.prototype,u=s.toString;e.exports=n},function(e,t){function r(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}var n=9007199254740991;e.exports=r},function(e,t,r){function n(e){return"symbol"==typeof e||o(e)&&s.call(e)==i}var o=r(10),i="[object Symbol]",a=Object.prototype,s=a.toString;e.exports=n},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var o=r(141),i=r(142),a=r(143),s=r(144),u=r(145);n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=a,n.prototype.has=s,n.prototype.set=u,e.exports=n},function(e,t,r){function n(e){this.__data__=new o(e)}var o=r(12),i=r(148),a=r(149),s=r(150),u=r(151),c=r(152);n.prototype.clear=i,n.prototype.delete=a,n.prototype.get=s,n.prototype.has=u,n.prototype.set=c,e.exports=n},function(e,t,r){var n=r(2),o=n.Symbol;e.exports=o},function(e,t){function r(e,t,r,n){var o=-1,i=e?e.length:0;for(n&&i&&(r=e[++o]);++o<i;)r=t(r,e[o],o,e);return r}e.exports=r},function(e,t,r){function n(e,t,r){var n=e[t];a.call(e,t)&&o(n,r)&&(void 0!==r||t in e)||(e[t]=r)}var o=r(32),i=Object.prototype,a=i.hasOwnProperty;e.exports=n},function(e,t,r){function n(e){var t=new e.constructor(e.byteLength);return new o(t).set(new o(e)),t}var o=r(39);e.exports=n},function(e,t,r){function n(e,t,r,n){r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],u=n?n(r[s],e[s],s,r,e):e[s];o(r,s,u)}return r}var o=r(27);e.exports=n},function(e,t,r){function n(e){return p.call(e)}var o=r(67),i=r(38),a=r(69),s=r(71),u=r(73),c=r(56),f=Object.prototype,p=f.toString,l=c(o),v=c(i),d=c(a),g=c(s),E=c(u);(o&&"[object DataView]"!=n(new o(new ArrayBuffer(1)))||i&&"[object Map]"!=n(new i)||a&&"[object Promise]"!=n(a.resolve())||s&&"[object Set]"!=n(new s)||u&&"[object WeakMap]"!=n(new u))&&(n=function(e){var t=p.call(e),r="[object Object]"==t?e.constructor:void 0,n=r?c(r):void 0;if(n)switch(n){case l:return"[object DataView]";case v:return"[object Map]";case d:return"[object Promise]";case g:return"[object Set]";case E:return"[object WeakMap]"}return t}),e.exports=n},function(e,t){function r(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}e.exports=r},function(e,t){function r(e,t){return e===t||e!==e&&t!==t}e.exports=r},function(e,t,r){function n(e,t){return e&&o(e,i(t,3))}var o=r(42),i=r(8);e.exports=n},function(e,t,r){function n(e){return o(e)&&s.call(e,"callee")&&(!c.call(e,"callee")||u.call(e)==i)}var o=r(161),i="[object Arguments]",a=Object.prototype,s=a.hasOwnProperty,u=a.toString,c=a.propertyIsEnumerable;e.exports=n},function(e,t,r){function n(e){return"string"==typeof e||!o(e)&&i(e)&&u.call(e)==a}var o=r(0),i=r(10),a="[object String]",s=Object.prototype,u=s.toString;e.exports=n},function(e,t,r){var n=r(6),o=r(1),i=r(3),a="PROJECT_CONFIG",s=o.ERROR_MESSAGES;e.exports={createProjectConfig:function(e){var t=n.cloneDeep(e);n.forEach(t.audiences,function(e){e.conditions=JSON.parse(e.conditions)}),t.attributeKeyMap=n.keyBy(t.attributes,"key"),t.eventKeyMap=n.keyBy(t.events,"key"),t.groupIdMap=n.keyBy(t.groups,"id");var r;return n.forEach(t.groupIdMap,function(e,o){r=n.cloneDeep(e.experiments),n.forEach(r,function(e){t.experiments.push(n.assignIn(e,{groupId:o}))})}),t.experimentKeyMap=n.keyBy(t.experiments,"key"),t.experimentIdMap=n.keyBy(t.experiments,"id"),t.variationIdMap={},n.forEach(t.experiments,function(e){e.variationKeyMap=n.keyBy(e.variations,"key"),n.assignIn(t.variationIdMap,n.keyBy(e.variations,"id"))}),t},getExperimentId:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(s.INVALID_EXPERIMENT_KEY,a,t));return r.id},getLayerId:function(e,t){var r=e.experimentIdMap[t];if(n.isEmpty(r))throw new Error(i(s.INVALID_EXPERIMENT_ID,a,t));return r.layerId},getAttributeId:function(e,t){var r=e.attributeKeyMap[t];return r?r.id:null},getEventId:function(e,t){var r=e.eventKeyMap[t];return r?r.id:null},getExperimentStatus:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(s.INVALID_EXPERIMENT_KEY,a,t));return r.status},isActive:function(t,r){return"Running"===e.exports.getExperimentStatus(t,r)||"Launched"===e.exports.getExperimentStatus(t,r)},isRunning:function(t,r){return"Running"===e.exports.getExperimentStatus(t,r)},getAudiencesForExperiment:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(s.INVALID_EXPERIMENT_KEY,a,t));var o=r.audienceIds;return n.filter(e.audiences,function(e){return-1!==o.indexOf(e.id)})},getVariationKeyFromId:function(e,t){return e.variationIdMap.hasOwnProperty(t)?e.variationIdMap[t].key:null},getVariationIdFromExperimentAndVariationKey:function(e,t,r){var n=e.experimentKeyMap[t];return n.variationKeyMap.hasOwnProperty(r)?n.variationKeyMap[r].id:null},getExperimentIdsForEvent:function(e,t){var r=e.eventKeyMap[t];if(r)return r.experimentIds.length>0?r.experimentIds:null;throw new Error(i(s.INVALID_EVENT_KEY,a,t))},getTrafficAllocation:function(e,t){var r=e.experimentKeyMap[t];if(n.isEmpty(r))throw new Error(i(s.INVALID_EXPERIMENT_KEY,a,t));return r.trafficAllocation}}},function(e,t){function r(e){var t=n.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}e.exports=r;var n=Object.prototype.toString},function(e,t,r){var n=r(9),o=r(2),i=n(o,"Map");e.exports=i},function(e,t,r){var n=r(2),o=n.Uint8Array;e.exports=o},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0;++r<n&&!1!==t(e[r],r,e););return e}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}e.exports=r},function(e,t,r){function n(e,t){return e&&o(e,t,i)}var o=r(86),i=r(5);e.exports=n},function(e,t,r){function n(e,t){t=i(t,e)?[t]:o(t);for(var r=0,n=t.length;null!=e&&r<n;)e=e[a(t[r++])];return r&&r==n?e:void 0}var o=r(47),i=r(16),a=r(19);e.exports=n},function(e,t,r){function n(e,t){return null!=e&&(a.call(e,t)||"object"==typeof e&&t in e&&null===o(e))}var o=r(49),i=Object.prototype,a=i.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t,r,s,u){return e===t||(null==e||null==t||!i(e)&&!a(t)?e!==e&&t!==t:o(e,t,n,r,s,u))}var o=r(89),i=r(4),a=r(10);e.exports=n},function(e,t){function r(e){return function(t){return null==t?void 0:t[e]}}e.exports=r},function(e,t,r){function n(e){return o(e)?e:i(e)}var o=r(0),i=r(153);e.exports=n},function(e,t,r){function n(e,t,r,n,u,c){var f=u&s,p=e.length,l=t.length;if(p!=l&&!(f&&l>p))return!1;var v=c.get(e);if(v)return v==t;var d=-1,g=!0,E=u&a?new o:void 0;for(c.set(e,t);++d<p;){var h=e[d],y=t[d];if(n)var _=f?n(y,h,d,t,e,c):n(h,y,d,e,t,c);if(void 0!==_){if(_)continue;g=!1;break}if(E){if(!i(t,function(e,t){if(!E.has(t)&&(h===e||r(h,e,n,u,c)))return E.add(t)})){g=!1;break}}else if(h!==y&&!r(h,y,n,u,c)){g=!1;break}}return c.delete(e),g}var o=r(72),i=r(80),a=1,s=2;e.exports=n},function(e,t){function r(e){return n(Object(e))}var n=Object.getPrototypeOf;e.exports=r},function(e,t,r){function n(e){return i(Object(e))}var o=r(171),i=Object.getOwnPropertySymbols;i||(n=o),e.exports=n},function(e,t,r){function n(e){var t=e?e.length:void 0;return s(t)&&(a(e)||u(e)||i(e))?o(t,String):null}var o=r(99),i=r(34),a=r(0),s=r(21),u=r(35);e.exports=n},function(e,t,r){function n(e){return e===e&&!o(e)}var o=r(4);e.exports=n},function(e,t){function r(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}e.exports=r},function(e,t){function r(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}e.exports=r},function(e,t){function r(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}e.exports=r},function(e,t){function r(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var n=Function.prototype.toString;e.exports=r},function(e,t,r){(function(e){var n=r(2),o=r(172),i="object"==typeof t&&t,a=i&&"object"==typeof e&&e,s=a&&a.exports===i,u=s?n.Buffer:void 0,c=u?function(e){return e instanceof u}:o;e.exports=c}).call(t,r(198)(e))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(6),o=r(188),i=r(185),a=r(66),s=r(1),u=r(186),c=r(183);e.exports={createInstance:function(e){var t="logLevel"in e?e.logLevel:s.LOG_LEVEL.INFO,r=u.createLogger({logLevel:s.LOG_LEVEL.INFO});if(e)try{o.validate(e),e.isValidInstance=!0}catch(t){var f="INDEX:"+t.message;e.logger?e.logger.log(s.LOG_LEVEL.ERROR,f):r.log(s.LOG_LEVEL.ERROR,f),e.isValidInstance=!1}return e=n.assignIn({clientEngine:s.JAVASCRIPT_CLIENT_ENGINE,clientVersion:"1.4.1",errorHandler:i,eventDispatcher:a,logger:u.createLogger({logLevel:t})},e),new c(e)}}},function(e,t,r){function n(e,t,r){if(!e||"string"!=typeof e)throw new TypeError("must specify a URL");if("function"==typeof t&&(r=t,t={}),r&&"function"!=typeof r)throw new TypeError("expected cb to be undefined or a function");r=r||f,t=t||{};var n=t.json?"json":"text";t=a({responseType:n},t);var p=t.headers||{},l=(t.method||"GET").toUpperCase(),v=t.query;return v&&("string"!=typeof v&&(v=o.stringify(v)),e=i(e,v)),"json"===t.responseType&&s(p,"Accept",c),t.json&&"GET"!==l&&"HEAD"!==l&&(s(p,"Content-Type",c),t.body=JSON.stringify(t.body)),t.method=l,t.url=e,t.headers=p,delete t.query,delete t.json,u(t,r)}var o=r(194),i=r(197),a=r(202),s=r(199),u=r(201),c="application/json",f=function(){};e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.OPTIMIZELY_IS_FETCHING=void 0;var o=r(59),i=n(o),a=r(60),s=n(a),u=t.OPTIMIZELY_IS_FETCHING="OPTIMIZELY_IS_FETCHING",c=function(){function e(e){return c=e,c.optimizelyInstanceExtender=c.optimizelyInstanceExtender||{},t(),a}function t(){(0,s.default)(c.url,{json:!0},function(e,t){e||!t?c.onDataFetchError&&c.onDataFetchError(e):r(t)})}function r(e){var t=Object.assign({},{datafile:e},c.createInstanceParams),r=i.default.createInstance(t);for(var a in r)!function(e){if("function"==typeof r[e]){var t="function"==typeof c.optimizelyInstanceExtender[e]?c.optimizelyInstanceExtender[e]:function(){};n[e]=function(){var n=r[e].apply(r,arguments);return t(n,arguments),n}}}(a);if(c.onDataFetchSuccess&&c.onDataFetchSuccess(e,r,n),o.length)for(var s=0;s<o.length;s++)o[s](null,n)}var n=void 0,o=[],a={activate:function(e,t,r,n){return n&&o.push(n),u}},c=void 0;return{getInstance:function(t){return n||(n=e(t)),n}}};t.default=c},function(e,t,r){function n(e,t,r){if(!s(t))throw new TypeError("iterator must be a function");arguments.length<3&&(r=this),"[object Array]"===u.call(e)?o(e,t,r):"string"==typeof e?i(e,t,r):a(e,t,r)}function o(e,t,r){for(var n=0,o=e.length;n<o;n++)c.call(e,n)&&t.call(r,e[n],n,e)}function i(e,t,r){for(var n=0,o=e.length;n<o;n++)t.call(r,e.charAt(n),n,e)}function a(e,t,r){for(var n in e)c.call(e,n)&&t.call(r,e[n],n,e)}var s=r(37);e.exports=n;var u=Object.prototype.toString,c=Object.prototype.hasOwnProperty},function(e,t,r){(function(t){var r;r="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e.exports=r}).call(t,r(58))},function(e,t,r){var n,o;!function(r,i){n=[],void 0!==(o=function(){return i()}.apply(t,n))&&(e.exports=o)}(0,function(){function e(t,r){return e(t,r,{changing:!1})}var t=e;t.Integer={type:"integer"};var r={String:String,Boolean:Boolean,Number:Number,Object:Object,Array:Array,Date:Date};t.validate=e,t.checkPropertyChange=function(t,r,n){return e(t,r,{changing:n||"property"})};var e=t._validate=function(e,t,n){function o(e){return e.type||r[e.name]==e&&e.name.toLowerCase()}function i(e,t,r,c){function f(e){u.push({property:r,message:e})}function p(e,t){if(e){if(!("string"!=typeof e||"any"==e||("null"==e?null===t:typeof t==e)||t instanceof Array&&"array"==e||t instanceof Date&&"date"==e||"integer"==e&&t%1==0))return[{property:r,message:typeof t+" value found, but a "+e+" is required"}];if(e instanceof Array){for(var n=[],o=0;o<e.length&&(n=p(e[o],t)).length;o++);if(n.length)return n}else if("object"==typeof e){var a=u;u=[],i(t,e,r);var s=u;return u=a,s}}return[]}var l;if(r+=r?"number"==typeof c?"["+c+"]":void 0===c?"":"."+c:c,("object"!=typeof t||t instanceof Array)&&(r||"function"!=typeof t)&&(!t||!o(t)))return"function"==typeof t?e instanceof t||f("is not an instance of the class/constructor "+t.name):t&&f("Invalid schema/property definition "+t),null;if(s&&t.readonly&&f("is a readonly field, it can not be changed"),t.extends&&i(e,t.extends,r,c),void 0===e)t.required&&f("is missing and it is required");else if(u=u.concat(p(o(t),e)),t.disallow&&!p(t.disallow,e).length&&f(" disallowed value was matched"),null!==e){if(e instanceof Array){if(t.items){var v=t.items instanceof Array,d=t.items;for(c=0,l=e.length;c<l;c+=1)v&&(d=t.items[c]),n.coerce&&(e[c]=n.coerce(e[c],d)),u.concat(i(e[c],d,r,c))}t.minItems&&e.length<t.minItems&&f("There must be a minimum of "+t.minItems+" in the array"),t.maxItems&&e.length>t.maxItems&&f("There must be a maximum of "+t.maxItems+" in the array")}else(t.properties||t.additionalProperties)&&u.concat(a(e,t.properties,r,t.additionalProperties));if(t.pattern&&"string"==typeof e&&!e.match(t.pattern)&&f("does not match the regex pattern "+t.pattern),t.maxLength&&"string"==typeof e&&e.length>t.maxLength&&f("may only be "+t.maxLength+" characters long"),t.minLength&&"string"==typeof e&&e.length<t.minLength&&f("must be at least "+t.minLength+" characters long"),void 0!==typeof t.minimum&&typeof e==typeof t.minimum&&t.minimum>e&&f("must have a minimum value of "+t.minimum),void 0!==typeof t.maximum&&typeof e==typeof t.maximum&&t.maximum<e&&f("must have a maximum value of "+t.maximum),t.enum){var g=t.enum;l=g.length;for(var E,h=0;h<l;h++)if(g[h]===e){E=1;break}E||f("does not have a value in the enumeration "+g.join(", "))}"number"==typeof t.maxDecimal&&e.toString().match(new RegExp("\\.[0-9]{"+(t.maxDecimal+1)+",}"))&&f("may only have "+t.maxDecimal+" digits of decimal places")}return null}function a(e,t,r,o){if("object"==typeof t){("object"!=typeof e||e instanceof Array)&&u.push({property:r,message:"an object is required"});for(var a in t)if(t.hasOwnProperty(a)){var c=e[a];if(void 0===c&&n.existingOnly)continue;var f=t[a];void 0===c&&f.default&&(c=e[a]=f.default),n.coerce&&a in e&&(c=e[a]=n.coerce(c,f)),i(c,f,r,a)}}for(a in e){if(e.hasOwnProperty(a)&&("_"!=a.charAt(0)||"_"!=a.charAt(1))&&t&&!t[a]&&!1===o){if(n.filter){delete e[a];continue}u.push({property:r,message:typeof c+"The property "+a+" is not defined in the schema and the schema does not allow additional properties"})}var p=t&&t[a]&&t[a].requires;!p||p in e||u.push({property:r,message:"the presence of the property "+a+" requires that "+p+" also be present"}),c=e[a],!o||t&&"object"==typeof t&&a in t||(n.coerce&&(c=e[a]=n.coerce(c,o)),i(c,o,r,a)),!s&&c&&c.$schema&&(u=u.concat(i(c,c.$schema,r,a)))}return u}n||(n={});var s=n.changing,u=[];return t&&i(e,t,"",s||""),!s&&e&&e.$schema&&i(e,e.$schema,"",""),{valid:!u.length,errors:u}};return t.mustBeValid=function(e){if(!e.valid)throw new TypeError(e.errors.map(function(e){return"for property "+e.property+": "+e.message}).join(", \n"))},t})},function(e,t,r){!function(){function t(e,t){for(var r,n=e.length,o=t^n,i=0;n>=4;)r=255&e.charCodeAt(i)|(255&e.charCodeAt(++i))<<8|(255&e.charCodeAt(++i))<<16|(255&e.charCodeAt(++i))<<24,r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16),r^=r>>>24,r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)^r,n-=4,++i;switch(n){case 3:o^=(255&e.charCodeAt(i+2))<<16;case 2:o^=(255&e.charCodeAt(i+1))<<8;case 1:o^=255&e.charCodeAt(i),o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16)}return o^=o>>>13,o=1540483477*(65535&o)+((1540483477*(o>>>16)&65535)<<16),(o^=o>>>15)>>>0}function r(e,t){var r,n,o,i,a,s,u,c;for(r=3&e.length,n=e.length-r,o=t,a=3432918353,s=461845907,c=0;c<n;)u=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*s+(((u>>>16)*s&65535)<<16)&4294967295,o^=u,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=27492+(65535&i)+((58964+(i>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(c+2))<<16;case 2:u^=(255&e.charCodeAt(c+1))<<8;case 1:u^=255&e.charCodeAt(c),u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295,u=u<<15|u>>>17,u=(65535&u)*s+(((u>>>16)*s&65535)<<16)&4294967295,o^=u}return o^=e.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,(o^=o>>>16)>>>0}var n=r;n.v2=t,n.v3=r;e.exports=n}()},function(e,t,r){var n=r(6);e.exports={dispatchEvent:function(e,t){var r=e.url,n=e.params;if("POST"===e.httpVerb){var i=new XMLHttpRequest;i.open("POST",r,!0),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){4===i.readyState&&t&&"function"==typeof t&&t(n)},i.send(JSON.stringify(n))}else{r+="?wxhr=true",n&&(r+="&"+o(n));var i=new XMLHttpRequest;i.open("GET",r,!0),i.onreadystatechange=function(){4===i.readyState&&t&&"function"==typeof t&&t()},i.send()}}};var o=function(e){return n.map(e,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")}},function(e,t,r){var n=r(9),o=r(2),i=n(o,"DataView");e.exports=i},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}var o=r(124),i=r(125),a=r(126),s=r(127),u=r(128);n.prototype.clear=o,n.prototype.delete=i,n.prototype.get=a,n.prototype.has=s,n.prototype.set=u,e.exports=n},function(e,t,r){var n=r(9),o=r(2),i=n(o,"Promise");e.exports=i},function(e,t,r){var n=r(2),o=n.Reflect;e.exports=o},function(e,t,r){var n=r(9),o=r(2),i=n(o,"Set");e.exports=i},function(e,t,r){function n(e){var t=-1,r=e?e.length:0;for(this.__data__=new o;++t<r;)this.add(e[t])}var o=r(23),i=r(146),a=r(147);n.prototype.add=n.prototype.push=i,n.prototype.has=a,e.exports=n},function(e,t,r){var n=r(9),o=r(2),i=n(o,"WeakMap");e.exports=i},function(e,t){function r(e,t){return e.set(t[0],t[1]),e}e.exports=r},function(e,t){function r(e,t){return e.add(t),e}e.exports=r},function(e,t){function r(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}e.exports=r},function(e,t){function r(e,t,r,n){for(var o=-1,i=e?e.length:0;++o<i;){var a=e[o];t(n,a,r(a),e)}return n}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=e?e.length:0;++r<n;)if(t(e[r],r,e))return!0;return!1}e.exports=r},function(e,t,r){function n(e,t,r,n){return o(e,function(e,o,i){t(n,e,r(e),i)}),n}var o=r(11);e.exports=n},function(e,t,r){function n(e,t){return e&&o(t,i(t),e)}var o=r(29),i=r(5);e.exports=n},function(e,t,r){function n(e,t,r,A,N,j,T){var S;if(A&&(S=j?A(e,N,j,T):A(e)),void 0!==S)return S;if(!_(e))return e;var w=E(e);if(w){if(S=v(e),!t)return c(e,S)}else{var L=l(e),D=L==b||L==m;if(h(e))return u(e,t);if(L==x||L==O||D&&!j){if(y(e))return j?e:{};if(S=g(D?{}:e),!t)return f(e,s(S,e))}else{if(!R[L])return j?e:{};S=d(e,L,n,t)}}T||(T=new o);var V=T.get(e);if(V)return V;if(T.set(e,S),!w)var C=r?p(e):I(e);return i(C||e,function(o,i){C&&(i=o,o=e[i]),a(S,i,n(o,t,r,A,i,e,T))}),S}var o=r(24),i=r(40),a=r(27),s=r(82),u=r(103),c=r(110),f=r(111),p=r(119),l=r(30),v=r(129),d=r(130),g=r(131),E=r(0),h=r(57),y=r(31),_=r(4),I=r(5),O="[object Arguments]",b="[object Function]",m="[object GeneratorFunction]",x="[object Object]",R={};R[O]=R["[object Array]"]=R["[object ArrayBuffer]"]=R["[object DataView]"]=R["[object Boolean]"]=R["[object Date]"]=R["[object Float32Array]"]=R["[object Float64Array]"]=R["[object Int8Array]"]=R["[object Int16Array]"]=R["[object Int32Array]"]=R["[object Map]"]=R["[object Number]"]=R[x]=R["[object RegExp]"]=R["[object Set]"]=R["[object String]"]=R["[object Symbol]"]=R["[object Uint8Array]"]=R["[object Uint8ClampedArray]"]=R["[object Uint16Array]"]=R["[object Uint32Array]"]=!0,R["[object Error]"]=R[b]=R["[object WeakMap]"]=!1,e.exports=n},function(e,t,r){function n(e){return o(e)?i(e):{}}var o=r(4),i=Object.create;e.exports=n},function(e,t,r){function n(e,t){var r=[];return o(e,function(e,n,o){t(e,n,o)&&r.push(e)}),r}var o=r(11);e.exports=n},function(e,t,r){var n=r(116),o=n();e.exports=o},function(e,t,r){function n(e,t,r){var n=t(e);return i(e)?n:o(n,r(e))}var o=r(79),i=r(0);e.exports=n},function(e,t){function r(e,t){return null!=e&&t in Object(e)}e.exports=r},function(e,t,r){function n(e,t,r,n,E,y){var _=c(e),I=c(t),O=d,b=d;_||(O=u(e),O=O==v?g:O),I||(b=u(t),b=b==v?g:b);var m=O==g&&!f(e),x=b==g&&!f(t),R=O==b;if(R&&!m)return y||(y=new o),_||p(e)?i(e,t,r,n,E,y):a(e,t,O,r,n,E,y);if(!(E&l)){var A=m&&h.call(e,"__wrapped__"),N=x&&h.call(t,"__wrapped__");if(A||N){var j=A?e.value():e,T=N?t.value():t;return y||(y=new o),r(j,T,n,E,y)}}return!!R&&(y||(y=new o),s(e,t,r,n,E,y))}var o=r(24),i=r(48),a=r(117),s=r(118),u=r(30),c=r(0),f=r(31),p=r(163),l=2,v="[object Arguments]",d="[object Array]",g="[object Object]",E=Object.prototype,h=E.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t,r,n){var u=r.length,c=u,f=!n;if(null==e)return!c;for(e=Object(e);u--;){var p=r[u];if(f&&p[2]?p[1]!==e[p[0]]:!(p[0]in e))return!1}for(;++u<c;){p=r[u];var l=p[0],v=e[l],d=p[1];if(f&&p[2]){if(void 0===v&&!(l in e))return!1}else{var g=new o;if(n)var E=n(v,d,l,e,t,g);if(!(void 0===E?i(d,v,n,a|s,g):E))return!1}}return!0}var o=r(24),i=r(45),a=1,s=2;e.exports=n},function(e,t,r){function n(e){return!(!s(e)||a(e))&&(o(e)||i(e)?v:c).test(u(e))}var o=r(20),i=r(31),a=r(134),s=r(4),u=r(56),c=/^\[object .+?Constructor\]$/,f=Object.prototype,p=Function.prototype.toString,l=f.hasOwnProperty,v=RegExp("^"+p.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=n},function(e,t){function r(e){return n(Object(e))}var n=Object.keys;e.exports=r},function(e,t,r){function n(e){e=null==e?e:Object(e);var t=[];for(var r in e)t.push(r);return t}var o=r(70),i=r(135),a=Object.prototype,s=o?o.enumerate:void 0,u=a.propertyIsEnumerable;s&&!u.call({valueOf:1},"valueOf")&&(n=function(e){return i(s(e))}),e.exports=n},function(e,t,r){function n(e,t){var r=-1,n=i(e)?Array(e.length):[];return o(e,function(e,o,i){n[++r]=t(e,o,i)}),n}var o=r(11),i=r(7);e.exports=n},function(e,t,r){function n(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(r){return r===e||o(r,e,t)}}var o=r(90),i=r(121),a=r(54);e.exports=n},function(e,t,r){function n(e,t){return s(e)&&u(t)?c(f(e),t):function(r){var n=i(r,e);return void 0===n&&n===t?a(r,e):o(t,n,void 0,p|l)}}var o=r(45),i=r(158),a=r(159),s=r(16),u=r(52),c=r(54),f=r(19),p=1,l=2;e.exports=n},function(e,t,r){function n(e){return function(t){return o(t,e)}}var o=r(43);e.exports=n},function(e,t){function r(e,t,r,n,o){return o(e,function(e,o,i){r=n?(n=!1,e):t(r,e,o,i)}),r}e.exports=r},function(e,t){function r(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}e.exports=r},function(e,t,r){function n(e){if("string"==typeof e)return e;if(i(e))return u?u.call(e):"";var t=e+"";return"0"==t&&1/e==-a?"-0":t}var o=r(25),i=r(22),a=1/0,s=o?o.prototype:void 0,u=s?s.toString:void 0;e.exports=n},function(e,t,r){function n(e,t){return o(t,function(t){return e[t]})}var o=r(41);e.exports=n},function(e,t){function r(e){return e&&e.Object===Object?e:null}e.exports=r},function(e,t){function r(e,t){if(t)return e.slice();var r=new e.constructor(e.length);return e.copy(r),r}e.exports=r},function(e,t,r){function n(e,t){var r=t?o(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var o=r(28);e.exports=n},function(e,t,r){function n(e,t,r){var n=t?r(a(e),!0):a(e);return i(n,o,new e.constructor)}var o=r(74),i=r(26),a=r(53);e.exports=n},function(e,t){function r(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}var n=/\w*$/;e.exports=r},function(e,t,r){function n(e,t,r){var n=t?r(a(e),!0):a(e);return i(n,o,new e.constructor)}var o=r(75),i=r(26),a=r(55);e.exports=n},function(e,t,r){function n(e){return a?Object(a.call(e)):{}}var o=r(25),i=o?o.prototype:void 0,a=i?i.valueOf:void 0;e.exports=n},function(e,t,r){function n(e,t){var r=t?o(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var o=r(28);e.exports=n},function(e,t){function r(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}e.exports=r},function(e,t,r){function n(e,t){return o(e,i(e),t)}var o=r(29),i=r(50);e.exports=n},function(e,t,r){var n=r(2),o=n["__core-js_shared__"];e.exports=o},function(e,t,r){function n(e,t){return function(r,n){var u=s(r)?o:i,c=t?t():{};return u(r,e,a(n),c)}}var o=r(77),i=r(81),a=r(8),s=r(0);e.exports=n},function(e,t,r){function n(e){return i(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var u=r[n];u&&e(t,u,n,a)}return t})}var o=r(132),i=r(170);e.exports=n},function(e,t,r){function n(e,t){return function(r,n){if(null==r)return r;if(!o(r))return e(r,n);for(var i=r.length,a=t?i:-1,s=Object(r);(t?a--:++a<i)&&!1!==n(s[a],a,s););return r}}var o=r(7);e.exports=n},function(e,t){function r(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var u=a[e?s:++o];if(!1===r(i[u],u,i))break}return t}}e.exports=r},function(e,t,r){function n(e,t,r,n,o,b,x){switch(r){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case I:return!(e.byteLength!=t.byteLength||!n(new i(e),new i(t)));case p:case l:return+e==+t;case v:return e.name==t.name&&e.message==t.message;case g:return e!=+e?t!=+t:e==+t;case E:case y:return e==t+"";case d:var R=s;case h:var A=b&f;if(R||(R=u),e.size!=t.size&&!A)return!1;var N=x.get(e);return N?N==t:(b|=c,x.set(e,t),a(R(e),R(t),n,o,b,x));case _:if(m)return m.call(e)==m.call(t)}return!1}var o=r(25),i=r(39),a=r(48),s=r(53),u=r(55),c=1,f=2,p="[object Boolean]",l="[object Date]",v="[object Error]",d="[object Map]",g="[object Number]",E="[object RegExp]",h="[object Set]",y="[object String]",_="[object Symbol]",I="[object ArrayBuffer]",O="[object DataView]",b=o?o.prototype:void 0,m=b?b.valueOf:void 0;e.exports=n},function(e,t,r){function n(e,t,r,n,s,u){var c=s&a,f=i(e),p=f.length;if(p!=i(t).length&&!c)return!1;for(var l=p;l--;){var v=f[l];if(!(c?v in t:o(t,v)))return!1}var d=u.get(e);if(d)return d==t;var g=!0;u.set(e,t);for(var E=c;++l<p;){v=f[l];var h=e[v],y=t[v];if(n)var _=c?n(y,h,v,t,e,u):n(h,y,v,e,t,u);if(!(void 0===_?h===y||r(h,y,n,s,u):_)){g=!1;break}E||(E="constructor"==v)}if(g&&!E){var I=e.constructor,O=t.constructor;I!=O&&"constructor"in e&&"constructor"in t&&!("function"==typeof I&&I instanceof I&&"function"==typeof O&&O instanceof O)&&(g=!1)}return u.delete(e),g}var o=r(44),i=r(5),a=2;e.exports=n},function(e,t,r){function n(e){return o(e,a,i)}var o=r(87),i=r(50),a=r(5);e.exports=n},function(e,t,r){var n=r(46),o=n("length");e.exports=o},function(e,t,r){function n(e){for(var t=i(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,o(a)]}return t}var o=r(52),i=r(5);e.exports=n},function(e,t){function r(e,t){return null==e?void 0:e[t]}e.exports=r},function(e,t,r){function n(e,t,r){t=u(t,e)?[t]:o(t);for(var n,l=-1,v=t.length;++l<v;){var d=p(t[l]);if(!(n=null!=e&&r(e,d)))break;e=e[d]}if(n)return n;var v=e?e.length:0;return!!v&&c(v)&&s(d,v)&&(a(e)||f(e)||i(e))}var o=r(47),i=r(34),a=r(0),s=r(15),u=r(16),c=r(21),f=r(35),p=r(19);e.exports=n},function(e,t,r){function n(){this.__data__=o?o(null):{}}var o=r(18);e.exports=n},function(e,t){function r(e){return this.has(e)&&delete this.__data__[e]}e.exports=r},function(e,t,r){function n(e){var t=this.__data__;if(o){var r=t[e];return r===i?void 0:r}return s.call(t,e)?t[e]:void 0}var o=r(18),i="__lodash_hash_undefined__",a=Object.prototype,s=a.hasOwnProperty;e.exports=n},function(e,t,r){function n(e){var t=this.__data__;return o?void 0!==t[e]:a.call(t,e)}var o=r(18),i=Object.prototype,a=i.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t){return this.__data__[e]=o&&void 0===t?i:t,this}var o=r(18),i="__lodash_hash_undefined__";e.exports=n},function(e,t){function r(e){var t=e.length,r=e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var n=Object.prototype,o=n.hasOwnProperty;e.exports=r},function(e,t,r){function n(e,t,r,n){var S=e.constructor;switch(t){case _:return o(e);case p:case l:return new S(+e);case I:return i(e,n);case O:case b:case m:case x:case R:case A:case N:case j:case T:return f(e,n);case v:return a(e,n,r);case d:case h:return new S(e);case g:return s(e);case E:return u(e,n,r);case y:return c(e)}}var o=r(28),i=r(104),a=r(105),s=r(106),u=r(107),c=r(108),f=r(109),p="[object Boolean]",l="[object Date]",v="[object Map]",d="[object Number]",g="[object RegExp]",E="[object Set]",h="[object String]",y="[object Symbol]",_="[object ArrayBuffer]",I="[object DataView]",O="[object Float32Array]",b="[object Float64Array]",m="[object Int8Array]",x="[object Int16Array]",R="[object Int32Array]",A="[object Uint8Array]",N="[object Uint8ClampedArray]",j="[object Uint16Array]",T="[object Uint32Array]";e.exports=n},function(e,t,r){function n(e){return"function"!=typeof e.constructor||a(e)?{}:o(i(e))}var o=r(84),i=r(49),a=r(17);e.exports=n},function(e,t,r){function n(e,t,r){if(!s(r))return!1;var n=typeof t;return!!("number"==n?i(r)&&a(t,r.length):"string"==n&&t in r)&&o(r[t],e)}var o=r(32),i=r(7),a=r(15),s=r(4);e.exports=n},function(e,t){function r(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}e.exports=r},function(e,t,r){function n(e){return!!i&&i in e}var o=r(112),i=function(){var e=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=n},function(e,t){function r(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}e.exports=r},function(e,t){function r(){this.__data__=[]}e.exports=r},function(e,t,r){function n(e){var t=this.__data__,r=o(t,e);return!(r<0)&&(r==t.length-1?t.pop():a.call(t,r,1),!0)}var o=r(13),i=Array.prototype,a=i.splice;e.exports=n},function(e,t,r){function n(e){var t=this.__data__,r=o(t,e);return r<0?void 0:t[r][1]}var o=r(13);e.exports=n},function(e,t,r){function n(e){return o(this.__data__,e)>-1}var o=r(13);e.exports=n},function(e,t,r){function n(e,t){var r=this.__data__,n=o(r,e);return n<0?r.push([e,t]):r[n][1]=t,this}var o=r(13);e.exports=n},function(e,t,r){function n(){this.__data__={hash:new o,map:new(a||i),string:new o}}var o=r(68),i=r(12),a=r(38);e.exports=n},function(e,t,r){function n(e){return o(this,e).delete(e)}var o=r(14);e.exports=n},function(e,t,r){function n(e){return o(this,e).get(e)}var o=r(14);e.exports=n},function(e,t,r){function n(e){return o(this,e).has(e)}var o=r(14);e.exports=n},function(e,t,r){function n(e,t){return o(this,e).set(e,t),this}var o=r(14);e.exports=n},function(e,t){function r(e){return this.__data__.set(e,n),this}var n="__lodash_hash_undefined__";e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t,r){function n(){this.__data__=new o}var o=r(12);e.exports=n},function(e,t){function r(e){return this.__data__.delete(e)}e.exports=r},function(e,t){function r(e){return this.__data__.get(e)}e.exports=r},function(e,t){function r(e){return this.__data__.has(e)}e.exports=r},function(e,t,r){function n(e,t){var r=this.__data__;return r instanceof o&&r.__data__.length==a&&(r=this.__data__=new i(r.__data__)),r.set(e,t),this}var o=r(12),i=r(23),a=200;e.exports=n},function(e,t,r){var n=r(167),o=r(176),i=n(function(e){var t=[];return o(e).replace(/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(\.|\[\])(?:\4|$))/g,function(e,r,n,o){t.push(n?o.replace(/\\(\\)?/g,"$1"):r||e)}),t});e.exports=i},function(e,t,r){var n=r(27),o=r(29),i=r(114),a=r(7),s=r(17),u=r(165),c=Object.prototype,f=c.propertyIsEnumerable,p=!f.call({valueOf:1},"valueOf"),l=i(function(e,t){if(p||s(t)||a(t))return void o(t,u(t),e);for(var r in t)n(e,r,t[r])});e.exports=l},function(e,t,r){function n(e){return o(e,!0,!0)}var o=r(83);e.exports=n},function(e,t,r){function n(e,t){return(s(e)?o:i)(e,a(t,3))}var o=r(78),i=r(85),a=r(8),s=r(0);e.exports=n},function(e,t,r){function n(e,t){return(s(e)?o:i)(e,a(t,3))}var o=r(40),i=r(11),a=r(8),s=r(0);e.exports=n},function(e,t,r){function n(e,t,r){var n=null==e?void 0:o(e,t);return void 0===n?r:n}var o=r(43);e.exports=n},function(e,t,r){function n(e,t){return null!=e&&i(e,t,o)}var o=r(88),i=r(123);e.exports=n},function(e,t){function r(e){return e}e.exports=r},function(e,t,r){function n(e){return i(e)&&o(e)}var o=r(7),i=r(10);e.exports=n},function(e,t,r){function n(e){if(s(e)&&(a(e)||p(e)||c(e.splice)||i(e)||u(e)))return!e.length;if(f(e)){var t=o(e);if(t==v||t==d)return!e.size}for(var r in e)if(E.call(e,r))return!1;return!(y&&l(e).length)}var o=r(30),i=r(34),a=r(0),s=r(7),u=r(57),c=r(20),f=r(10),p=r(35),l=r(5),v="[object Map]",d="[object Set]",g=Object.prototype,E=g.hasOwnProperty,h=g.propertyIsEnumerable,y=!h.call({valueOf:1},"valueOf");e.exports=n},function(e,t,r){function n(e){return i(e)&&o(e.length)&&!!a[u.call(e)]}var o=r(21),i=r(10),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=Object.prototype,u=s.toString;e.exports=n},function(e,t,r){var n=r(113),o=n(function(e,t,r){e[r]=t});e.exports=o},function(e,t,r){function n(e){for(var t=-1,r=s(e),n=o(e),u=n.length,f=i(e),p=!!f,l=f||[],v=l.length;++t<u;){var d=n[t];p&&("length"==d||a(d,v))||"constructor"==d&&(r||!c.call(e,d))||l.push(d)}return l}var o=r(93),i=r(51),a=r(15),s=r(17),u=Object.prototype,c=u.hasOwnProperty;e.exports=n},function(e,t,r){function n(e,t){return(s(e)?o:a)(e,i(t,3))}var o=r(41),i=r(8),a=r(94),s=r(0);e.exports=n},function(e,t,r){function n(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(i);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(n.Cache||o),r}var o=r(23),i="Expected a function";n.Cache=o,e.exports=n},function(e,t,r){function n(e){return a(e)?o(s(e)):i(e)}var o=r(46),i=r(97),a=r(16),s=r(19);e.exports=n},function(e,t,r){function n(e,t,r){var n=u(e)?o:s,c=arguments.length<3;return n(e,a(t,4),r,c,i)}var o=r(26),i=r(11),a=r(8),s=r(98),u=r(0);e.exports=n},function(e,t,r){function n(e,t){if("function"!=typeof e)throw new TypeError(a);return t=s(void 0===t?e.length-1:i(t),0),function(){for(var r=arguments,n=-1,i=s(r.length-t,0),a=Array(i);++n<i;)a[n]=r[t+n];switch(t){case 0:return e.call(this,a);case 1:return e.call(this,r[0],a);case 2:return e.call(this,r[0],r[1],a)}var u=Array(t+1);for(n=-1;++n<t;)u[n]=r[n];return u[t]=a,o(e,this,u)}}var o=r(76),i=r(174),a="Expected a function",s=Math.max;e.exports=n},function(e,t){function r(){return[]}e.exports=r},function(e,t){function r(){return!1}e.exports=r},function(e,t,r){function n(e){if(!e)return 0===e?e:0;if((e=o(e))===i||e===-i){return(e<0?-1:1)*a}return e===e?e:0}var o=r(175),i=1/0,a=1.7976931348623157e308;e.exports=n},function(e,t,r){function n(e){var t=o(e),r=t%1;return t===t?r?t-r:t:0}var o=r(173);e.exports=n},function(e,t,r){function n(e){if("number"==typeof e)return e;if(a(e))return s;if(i(e)){var t=o(e.valueOf)?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var r=f.test(e);return r||p.test(e)?l(e.slice(2),r?2:8):c.test(e)?s:+e}var o=r(20),i=r(4),a=r(22),s=NaN,u=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,p=/^0o[0-7]+$/i,l=parseInt;e.exports=n},function(e,t,r){function n(e){return null==e?"":o(e)}var o=r(100);e.exports=n},function(e,t,r){function n(e){return e?o(e,i(e)):[]}var o=r(101),i=r(5);e.exports=n},function(e,t,r){var n=r(180);e.exports={evaluate:function(e,t){if(!e||0===e.length)return!0;if(!t)return!1;for(var r=0;r<e.length;r++){var o=e[r],i=o.conditions;if(n.evaluate(i,t))return!0}return!1}}},function(e,t,r){var n=r(1),o=r(65),i=r(3),a=n.ERROR_MESSAGES,s=n.LOG_LEVEL,u=n.LOG_MESSAGES,c=Math.pow(2,32);e.exports={bucket:function(t){var r=t.experimentKeyMap[t.experimentKey],n=r.groupId;if(n){var o=t.groupIdMap[n];if(!o)throw new Error(i(a.INVALID_GROUP_ID,"BUCKETER",n));if("random"===o.policy){var c=e.exports._bucketUserIntoExperiment(o,t.userId,t.experimentId,t.logger);if(null===c){var f=i(u.USER_NOT_IN_ANY_EXPERIMENT,"BUCKETER",t.userId,n);return t.logger.log(s.INFO,f),null}if(c!==t.experimentId){var p=i(u.USER_NOT_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",t.userId,t.experimentKey,n);return t.logger.log(s.INFO,p),null}var l=i(u.USER_BUCKETED_INTO_EXPERIMENT_IN_GROUP,"BUCKETER",t.userId,t.experimentKey,n);t.logger.log(s.INFO,l)}}var v=i("%s%s",t.userId,t.experimentId),d=e.exports._generateBucketValue(v),g=i(u.USER_ASSIGNED_TO_VARIATION_BUCKET,"BUCKETER",d,t.userId);t.logger.log(s.DEBUG,g);var E=e.exports._findBucket(d,t.trafficAllocationConfig);if(null===E){var h=i(u.USER_HAS_NO_VARIATION,"BUCKETER",t.userId,t.experimentKey);t.logger.log(s.DEBUG,h)}else{if(""===E||!t.variationIdMap.hasOwnProperty(E)){var y=i(u.INVALID_VARIATION_ID,"BUCKETER");return t.logger.log(s.WARN,y),null}var _=t.variationIdMap[E].key,I=i(u.USER_HAS_VARIATION,"BUCKETER",t.userId,_,t.experimentKey);t.logger.log(s.INFO,I)}return E},_bucketUserIntoExperiment:function(t,r,n,o){var a=i("%s%s",r,t.id),c=e.exports._generateBucketValue(a);o.log(s.DEBUG,i(u.USER_ASSIGNED_TO_EXPERIMENT_BUCKET,"BUCKETER",c,r));var f=t.trafficAllocation;return e.exports._findBucket(c,f)},_findBucket:function(e,t){for(var r=0;r<t.length;r++)if(e<t[r].endOfRange)return t[r].entityId;return null},_generateBucketValue:function(e){try{var t=o.v3(e,1),r=t/c;return parseInt(1e4*r,10)}catch(t){throw new Error(i(a.INVALID_BUCKETING_ID,"BUCKETER",e,t.message))}}}},function(e,t){function r(e,t){if(Array.isArray(e)){var r=e[0];if(-1===f.indexOf(r))return!1;var p=e.slice(1);switch(r){case s:return n(p,t);case c:return o(p,t);case u:return i(p,t)}}return a([e.name,e.value],t)}function n(e,t){for(var n,o=0;o<e.length;o++)if(n=e[o],!r(n,t))return!1;return!0}function o(e,t){return 1===e.length&&!r(e[0],t)}function i(e,t){for(var n=0;n<e.length;n++){if(r(e[n],t))return!0}return!1}function a(e,t){return!!t.hasOwnProperty(e[0])&&t[e[0]]===e[1]}var s="and",u="or",c="not",f=[s,u,c];e.exports={evaluate:r}},function(e,t,r){function n(e){this.configObj=e.configObj,this.userProfileService=e.userProfileService||null,this.logger=e.logger}var o=r(178),i=r(179),a=r(1),s=r(6),u=r(36),c=r(3),f="DECISION_SERVICE",p=a.ERROR_MESSAGES,l=a.LOG_LEVEL,v=a.LOG_MESSAGES;n.prototype.getVariation=function(e,t,r){if(!this.__checkIfExperimentIsActive(e,t))return null;var n=this.configObj.experimentKeyMap[e],o=this.__getWhitelistedVariation(n,t);if(o)return o.key;var a=this.__getUserProfile(t);if(o=this.__getStoredVariation(n,a))return this.logger.log(l.INFO,c(v.RETURNING_STORED_VARIATION,f,o.key,e,t)),o.key;if(!this.__checkIfUserIsInAudience(e,t,r))return null;var s=this.__buildBucketerParams(e,t);return variationId=i.bucket(s),(o=this.configObj.variationIdMap[variationId])?(this.__saveUserProfile(a,n,o),o.key):null},n.prototype.__checkIfExperimentIsActive=function(e,t){if(!u.isActive(this.configObj,e)){var r=c(v.EXPERIMENT_NOT_RUNNING,f,e);return this.logger.log(l.INFO,r),!1}return!0},n.prototype.__getWhitelistedVariation=function(e,t){if(!s.isEmpty(e.forcedVariations)&&e.forcedVariations.hasOwnProperty(t)){var r=e.forcedVariations[t];if(e.variationKeyMap.hasOwnProperty(r)){var n=c(v.USER_FORCED_IN_VARIATION,f,t,r);return this.logger.log(l.INFO,n),e.variationKeyMap[r]}var o=c(v.FORCED_BUCKETING_FAILED,f,r,t);return this.logger.log(l.ERROR,o),null}return null},n.prototype.__checkIfUserIsInAudience=function(e,t,r){var n=u.getAudiencesForExperiment(this.configObj,e);if(!o.evaluate(n,r)){var i=c(v.USER_NOT_IN_EXPERIMENT,f,t,e);return this.logger.log(l.INFO,i),!1}return!0},n.prototype.__buildBucketerParams=function(e,t){var r={};return r.experimentKey=e,r.experimentId=u.getExperimentId(this.configObj,e),r.userId=t,r.trafficAllocationConfig=u.getTrafficAllocation(this.configObj,e),r.experimentKeyMap=this.configObj.experimentKeyMap,r.groupIdMap=this.configObj.groupIdMap,r.variationIdMap=this.configObj.variationIdMap,r.logger=this.logger,r},n.prototype.__getStoredVariation=function(e,t){if(!t||!t.experiment_bucket_map)return null;if(t.experiment_bucket_map.hasOwnProperty(e.id)){var r=t.experiment_bucket_map[e.id],n=r.variation_id;if(this.configObj.variationIdMap.hasOwnProperty(n))return this.configObj.variationIdMap[r.variation_id];this.logger.log(l.INFO,c(v.SAVED_VARIATION_NOT_FOUND,f,t.user_id,n,e.key))}return null},n.prototype.__getUserProfile=function(e){var t={user_id:e,experiment_bucket_map:{}};if(!this.userProfileService)return t;try{t=this.userProfileService.lookup(e)||t}catch(t){this.logger.log(l.ERROR,c(p.USER_PROFILE_LOOKUP_ERROR,f,e,t.message))}return t},n.prototype.__saveUserProfile=function(e,t,r){if(this.userProfileService)try{e.experiment_bucket_map[t.id]={variation_id:r.id},this.userProfileService.save(e),this.logger.log(l.INFO,c(v.SAVED_VARIATION,f,r.key,t.key,e.user_id))}catch(t){this.logger.log(l.ERROR,c(p.USER_PROFILE_SAVE_ERROR,f,e.user_id,t.message))}},e.exports={createDecisionService:function(e){return new n(e)}}},function(e,t,r){function n(e){var t=e.attributes,r=e.configObj,n=e.userId,o={accountId:r.accountId,projectId:r.projectId,revision:r.revision,visitorId:n,timestamp:Math.round((new Date).getTime()),isGlobalHoldback:!1,userFeatures:[],clientEngine:e.clientEngine,clientVersion:e.clientVersion};for(var i in t){var a=u.getAttributeId(e.configObj,i);if(a){var s={id:a,name:i,type:c,value:t[i],shouldIndex:!0};o.userFeatures.push(s)}}return o}function o(e,t,r){return{layerId:u.getLayerId(e,t),decision:{isLayerHoldback:!1,experimentId:t,variationId:r}}}function i(e,t,r,n){var o={eventEntityId:u.getEventId(e,t),eventName:t,eventFeatures:[],layerStates:[]};return s(n,function(t,r){var n={layerId:u.getLayerId(e,r),revision:e.revision,decision:{isLayerHoldback:!1,experimentId:r,variationId:t},actionTriggered:!0};o.layerStates.push(n)}),o.eventMetrics=[],r&&a.forEach(r,function(e,t){if(t===f){var r={name:f,value:e};o.eventMetrics.push(r)}var n={name:t,type:c,value:e,shouldIndex:!1};o.eventFeatures.push(n)}),o}var a=r(6),s=r(33),u=r(36),c="custom",f="revenue";e.exports={getImpressionEvent:function(e){var t={httpVerb:"POST"},r=n(e);t.url="https://logx.optimizely.com/log/decision";var i=o(e.configObj,e.experimentId,e.variationId);return t.params=a.assignIn(r,i),t},getConversionEvent:function(e){var t={httpVerb:"POST"},r=n(e);t.url="https://logx.optimizely.com/log/event";var o=i(e.configObj,e.eventKey,e.eventTags,e.experimentsToVariationMap);return t.params=a.assignIn(r,o),t}}},function(e,t,r){function n(e){var t=e.clientEngine;if(t!==s.NODE_CLIENT_ENGINE&&t!==s.JAVASCRIPT_CLIENT_ENGINE&&(e.logger.log(h.INFO,v(y.INVALID_CLIENT_ENGINE,_,t)),t=s.NODE_CLIENT_ENGINE),this.clientEngine=t,this.clientVersion=e.clientVersion||s.NODE_CLIENT_VERSION,this.errorHandler=e.errorHandler,this.eventDispatcher=e.eventDispatcher,this.isValidInstance=e.isValidInstance,this.logger=e.logger,e.datafile){if(!0===e.skipJSONValidation)this.configObj=p.createProjectConfig(e.datafile),this.logger.log(h.INFO,v(y.SKIPPING_JSON_VALIDATION,_));else try{f.validate(l,e.datafile)&&(this.configObj=p.createProjectConfig(e.datafile),this.logger.log(h.INFO,v(y.VALID_DATAFILE,_)))}catch(e){this.isValidInstance=!1,this.logger.log(h.ERROR,e.message),this.errorHandler.handleError(e)}var r=null;if(e.userProfileService)try{g.validate(e.userProfileService)&&(r=e.userProfileService,this.logger.log(h.INFO,v(y.VALID_USER_PROFILE_SERVICE,_)))}catch(e){this.logger.log(h.WARNING,e.message)}this.decisionService=a.createDecisionService({configObj:this.configObj,userProfileService:r,logger:this.logger})}else this.logger.log(h.ERROR,v(E.NO_DATAFILE_SPECIFIED,_)),this.errorHandler.handleError(new Error(v(E.NO_DATAFILE_SPECIFIED,_))),this.isValidInstance=!1}var o=r(6),i=r(187),a=r(181),s=r(1),u=r(182),c=r(189),f=r(190),p=r(36),l=r(184),v=r(3),d=r(191),g=r(192),E=s.ERROR_MESSAGES,h=s.LOG_LEVEL,y=s.LOG_MESSAGES,_="OPTIMIZELY";n.prototype.activate=function(e,t,r){if(!this.isValidInstance)return this.logger.log(h.ERROR,v(y.INVALID_OBJECT,_,"activate")),null;try{var n=this.getVariation(e,t,r);if(null===n)return this.__notActivatingExperiment(e,t);if(!p.isRunning(this.configObj,e)){var o=v(y.SHOULD_NOT_DISPATCH_ACTIVATE,_,e);return this.logger.log(h.DEBUG,o),n}var i=p.getVariationIdFromExperimentAndVariationKey(this.configObj,e,n),a=p.getExperimentId(this.configObj,e),s={attributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:this.configObj,experimentId:a,userId:t,variationId:i},c=u.getImpressionEvent(s),f=v(y.DISPATCH_IMPRESSION_EVENT,_,c.url,JSON.stringify(c.params));this.logger.log(h.DEBUG,f);var l=function(){var r=v(y.ACTIVATE_USER,_,t,e);this.logger.log(h.INFO,r)}.bind(this);return this.__dispatchEvent(c,l),n}catch(r){this.logger.log(h.ERROR,r.message);var d=v(y.NOT_ACTIVATING_USER,_,t,e);return this.logger.log(h.INFO,d),this.errorHandler.handleError(r),null}},n.prototype.track=function(e,t,r,n){if(!this.isValidInstance)return void this.logger.log(h.ERROR,v(y.INVALID_OBJECT,_,"track"));"number"==typeof n&&isFinite(n)&&(this.logger.log(h.WARNING,v(y.DEPRECATED_EVENT_VALUE,_,"track")),n={revenue:n});try{if(!this.__validateInputs(t,r,n))return;var o=this.__getValidExperimentsForEvent(e,t,r);if(!Object.keys(o).length)return void this.logger.log(h.WARNING,v(y.EVENT_NOT_ASSOCIATED_WITH_EXPERIMENTS,_,e));var i={attributes:r,clientEngine:this.clientEngine,clientVersion:this.clientVersion,configObj:this.configObj,eventKey:e,eventTags:n,userId:t,experimentsToVariationMap:o},a=u.getConversionEvent(i),s=v(y.DISPATCH_CONVERSION_EVENT,_,a.url,JSON.stringify(a.params));this.logger.log(h.DEBUG,s);var c=function(){var r=v(y.TRACK_EVENT,_,e,t);this.logger.log(h.INFO,r)}.bind(this);this.__dispatchEvent(a,c)}catch(e){this.logger.log(h.ERROR,e.message);var f=v(y.NOT_TRACKING_USER,_,t);this.logger.log(h.INFO,f),this.errorHandler.handleError(e)}},n.prototype.getVariation=function(e,t,r){if(!this.isValidInstance)return this.logger.log(h.ERROR,v(y.INVALID_OBJECT,_,"getVariation")),null;try{if(!this.__validateInputs(t,r))return null;var n=this.configObj.experimentKeyMap[e];if(o.isEmpty(n))throw new Error(v(E.INVALID_EXPERIMENT_KEY,_,e));return this.decisionService.getVariation(e,t,r)}catch(e){return this.logger.log(h.ERROR,e.message),this.errorHandler.handleError(e),null}},n.prototype.__validateInputs=function(e,t,r){try{return d.validate(e),t&&i.validate(t),r&&c.validate(r),!0}catch(e){return this.logger.log(h.ERROR,e.message),this.errorHandler.handleError(e),!1}},n.prototype.__getValidExperimentsForEvent=function(e,t,r){var n={},i=p.getExperimentIdsForEvent(this.configObj,e);return i?n=o.reduce(i,function(e,n){var o=this.configObj.experimentIdMap[n].key,i=this.getVariation(o,t,r);if(i)if(p.isRunning(this.configObj,o)){var a=p.getVariationIdFromExperimentAndVariationKey(this.configObj,o,i);e[n]=a}else{var s=v(y.SHOULD_NOT_DISPATCH_TRACK,_,o);this.logger.log(h.DEBUG,s)}else{var u=v(y.NOT_TRACKING_USER_FOR_EXPERIMENT,_,t,o);this.logger.log(h.DEBUG,u)}return e}.bind(this),{}):n},n.prototype.__notActivatingExperiment=function(e,t){var r=v(y.NOT_ACTIVATING_USER,_,t,e);return this.logger.log(h.INFO,r),null},n.prototype.__dispatchEvent=function(e,t){var r=this.eventDispatcher.dispatchEvent(e,t);"object"!=typeof r||r.hasOwnProperty("uri")||r.then(function(){t()})},e.exports=n},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{projectId:{type:"string",required:!0},accountId:{type:"string",required:!0},groups:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},policy:{type:"string",required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},experiments:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0},status:{type:"string",required:!0},layerId:{type:"string",required:!0},variations:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},audienceIds:{type:"array",items:{type:"string"},required:!0},forcedVariations:{type:"object",required:!0}}},required:!0}}},required:!0},experiments:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0},status:{type:"string",required:!0},layerId:{type:"string",required:!0},variations:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},trafficAllocation:{type:"array",items:{type:"object",properties:{entityId:{type:"string",required:!0},endOfRange:{type:"integer",required:!0}}},required:!0},audienceIds:{type:"array",items:{type:"string"},required:!0},forcedVariations:{type:"object",required:!0}}},required:!0},events:{type:"array",items:{type:"object",properties:{key:{type:"string",required:!0},experimentIds:{type:"array",items:{type:"string",required:!0}},id:{type:"string",required:!0}}},required:!0},audiences:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},name:{type:"string",required:!0},conditions:{type:"string",required:!0}}},required:!0},attributes:{type:"array",items:{type:"object",properties:{id:{type:"string",required:!0},key:{type:"string",required:!0}}},required:!0},version:{type:"string",required:!0},revision:{type:"string",required:!0}}}},function(e,t){e.exports={handleError:function(e){}}},function(e,t,r){function n(){}function o(e){e=s.assignIn({logLevel:u.LOG_LEVEL.ERROR,logToConsole:!0,prefix:"[OPTIMIZELY]"},e),this.setLogLevel(e.logLevel),this.logToConsole=e.logToConsole,this.prefix=e.prefix}function i(e){switch(e){case u.LOG_LEVEL.DEBUG:return"DEBUG";case u.LOG_LEVEL.INFO:return"INFO";case u.LOG_LEVEL.WARNING:return"WARNING";case u.LOG_LEVEL.ERROR:return"ERROR";default:return"NOTSET"}}function a(){return new Date}var s=r(6),u=r(1);n.prototype.log=function(){},o.prototype.log=function(e,t){this.__shouldLog(e)&&(this.prefix&&(t=this.prefix+" - "+this.logLevelName+" "+a()+" "+t),this.logToConsole&&this.__consoleLog(e,[t]))},o.prototype.setLogLevel=function(e){this.logLevel=s.values(u.LOG_LEVEL).indexOf(e)>-1?e:u.LOG_LEVEL.ERROR,this.logLevelName=i(this.logLevel),this.log("Setting log level to "+e)},o.prototype.__shouldLog=function(e){return e>=this.logLevel},o.prototype.__consoleLog=function(e,t){switch(e){case u.LOG_LEVEL.DEBUG:case u.LOG_LEVEL.INFO:console.log.apply(console,t);break;case u.LOG_LEVEL.WARNING:console.warn.apply(console,t);break;case u.LOG_LEVEL.ERROR:console.error.apply(console,t);break;default:console.log.apply(console,t)}},e.exports={createLogger:function(e){return new o(e)},createNoOpLogger:function(){return new n}}},function(e,t,r){var n=r(3),o=r(33),i=r(1).ERROR_MESSAGES;e.exports={validate:function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(n(i.INVALID_ATTRIBUTES,"ATTRIBUTES_VALIDATOR"));return o(e,function(e,t){if(void 0===e)throw new Error(n(i.UNDEFINED_ATTRIBUTE,"ATTRIBUTES_VALIDATOR",t))}),!0}}},function(e,t,r){var n=r(3),o=r(1).ERROR_MESSAGES;e.exports={validate:function(e){if(e.errorHandler&&"function"!=typeof e.errorHandler.handleError)throw new Error(n(o.INVALID_ERROR_HANDLER,"CONFIG_VALIDATOR"));if(e.eventDispatcher&&"function"!=typeof e.eventDispatcher.dispatchEvent)throw new Error(n(o.INVALID_EVENT_DISPATCHER,"CONFIG_VALIDATOR"));if(e.logger&&"function"!=typeof e.logger.log)throw new Error(n(o.INVALID_LOGGER,"CONFIG_VALIDATOR"));return!0}}},function(e,t,r){var n=r(3),o=r(1).ERROR_MESSAGES;e.exports={validate:function(e){if("object"!=typeof e||Array.isArray(e)||null===e)throw new Error(n(o.INVALID_EVENT_TAGS,"EVENT_TAGS_VALIDATOR"));return!0}}},function(e,t,r){var n=r(6),o=r(64).validate,i=r(3),a=r(1).ERROR_MESSAGES,s="JSON_SCHEMA_VALIDATOR";e.exports={validate:function(e,t){if(!e)throw new Error(i(a.JSON_SCHEMA_EXPECTED,s));if(!t)throw new Error(i(a.NO_JSON_PROVIDED,s));var r=o(t,e);if(r.valid)return!0;if(n.isArray(r.errors))throw new Error(i(a.INVALID_DATAFILE,s,r.errors[0].property,r.errors[0].message));throw new Error(i(a.INVALID_JSON,s))}}},function(e,t,r){var n=r(1),o=r(3),i=n.ERROR_MESSAGES;e.exports={validate:function(e){if("string"!=typeof e||""===e)throw new Error(o(i.INVALID_USER_ID,"USER_ID_VALIDATOR"));return!0}}},function(e,t,r){var n=r(3),o=r(1).ERROR_MESSAGES;e.exports={validate:function(e){if("function"!=typeof e.lookup)throw new Error(n(o.INVALID_USER_PROFILE_SERVICE,"USER_PROFILE_SERVICE_VALIDATOR","Missing function 'lookup'"));if("function"!=typeof e.save)throw new Error(n(o.INVALID_USER_PROFILE_SERVICE,"USER_PROFILE_SERVICE_VALIDATOR","Missing function 'save'"));return!0}}},function(e,t,r){var n=r(196),o=r(62),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};e.exports=function(e){if(!e)return{};var t={};return o(n(e).split("\n"),function(e){var r=e.indexOf(":"),o=n(e.slice(0,r)).toLowerCase(),a=n(e.slice(r+1));void 0===t[o]?t[o]=a:i(t[o])?t[o].push(a):t[o]=[t[o],a]}),t}},function(e,t,r){"use strict";var n=r(195);t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e){return"string"!=typeof e?{}:(e=e.trim().replace(/^(\?|#|&)/,""),e?e.split("&").reduce(function(e,t){var r=t.replace(/\+/g," ").split("="),n=r.shift(),o=r.length>0?r.join("="):void 0;return n=decodeURIComponent(n),o=void 0===o?null:decodeURIComponent(o),e.hasOwnProperty(n)?Array.isArray(e[n])?e[n].push(o):e[n]=[e[n],o]:e[n]=o,e},{}):{})},t.stringify=function(e){return e?Object.keys(e).sort().map(function(t){var r=e[t];return Array.isArray(r)?r.sort().map(function(e){return n(t)+"="+n(e)}).join("&"):n(t)+"="+n(r)}).filter(function(e){return e.length>0}).join("&"):""}},function(e,t,r){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},function(e,t){function r(e){return e.replace(/^\s*|\s*$/g,"")}t=e.exports=r,t.left=function(e){return e.replace(/^\s*/,"")},t.right=function(e){return e.replace(/\s*$/,"")}},function(e,t){function r(e,t){if(t){t=t.trim().replace(/^(\?|#|&)/,""),t=t?"?"+t:t;var r=e.split(/[\?\#]/),n=r[0];t&&/\:\/\/[^\/]*$/.test(n)&&(n+="/");var o=e.match(/(\#.*)$/);e=n+t,o&&(e+=o[0])}return e}e.exports=r},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){function r(e,t,r){var n=t.toLowerCase();e[t]||e[n]||(e[t]=r)}e.exports=r},function(e,t){function r(e,t){return t?{statusCode:t.statusCode,headers:t.headers,method:e.method,url:e.url,rawRequest:t.rawRequest?t.rawRequest:t}:null}e.exports=r},function(e,t,r){function n(e,t){delete e.uri;var r=!1;return"json"===e.responseType&&(e.responseType="text",r=!0),o(e,function(n,o,a){if(r&&!n)try{var s=o.rawRequest.responseText;a=JSON.parse(s)}catch(e){n=e}o=i(e,o),n?t(n,null,o):t(n,a,o)})}var o=r(203),i=r(200);e.exports=n},function(e,t,r){"use strict";function n(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function o(e){var t=Object.getOwnPropertyNames(e);return Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t.filter(function(t){return i.call(e,t)})}var i=Object.prototype.propertyIsEnumerable;e.exports=Object.assign||function(e,t){for(var r,i,a=n(e),s=1;s<arguments.length;s++){r=arguments[s],i=o(Object(r));for(var u=0;u<i.length;u++)a[i[u]]=r[i[u]]}return a}},function(e,t,r){"use strict";function n(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function o(e,t,r){var n=e;return f(t)?(r=t,"string"==typeof e&&(n={uri:e})):n=l(t,{uri:e}),n.callback=r,n}function i(e,t,r){return t=o(e,t,r),a(t)}function a(e){function t(){4===f.readyState&&setTimeout(a,0)}function r(){var e=void 0;if(e=f.response?f.response:f.responseText||s(f),I)try{e=JSON.parse(e)}catch(e){}return e}function o(e){return clearTimeout(d),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,c(e,O)}function a(){if(!v){var t;clearTimeout(d),t=e.useXDR&&void 0===f.status?200:1223===f.status?204:f.status;var n=O,o=null;return 0!==t?(n={body:r(),statusCode:t,method:E,headers:{},url:g,rawRequest:f},f.getAllResponseHeaders&&(n.headers=p(f.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),c(o,n,n.body)}}if(void 0===e.callback)throw new Error("callback argument missing");var u=!1,c=function(t,r,n){u||(u=!0,e.callback(t,r,n))},f=e.xhr||null;f||(f=e.cors||e.useXDR?new i.XDomainRequest:new i.XMLHttpRequest);var l,v,d,g=f.url=e.uri||e.url,E=f.method=e.method||"GET",h=e.body||e.data,y=f.headers=e.headers||{},_=!!e.sync,I=!1,O={body:void 0,headers:{},statusCode:0,method:E,url:g,rawRequest:f};if("json"in e&&!1!==e.json&&(I=!0,y.accept||y.Accept||(y.Accept="application/json"),"GET"!==E&&"HEAD"!==E&&(y["content-type"]||y["Content-Type"]||(y["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),f.onreadystatechange=t,f.onload=a,f.onerror=o,f.onprogress=function(){},f.onabort=function(){v=!0},f.ontimeout=o,f.open(E,g,!_,e.username,e.password),_||(f.withCredentials=!!e.withCredentials),!_&&e.timeout>0&&(d=setTimeout(function(){if(!v){v=!0,f.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",o(e)}},e.timeout)),f.setRequestHeader)for(l in y)y.hasOwnProperty(l)&&f.setRequestHeader(l,y[l]);else if(e.headers&&!n(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(f.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(f),f.send(h||null),f}function s(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function u(){}var c=r(63),f=r(37),p=r(193),l=r(204);e.exports=i,i.XMLHttpRequest=c.XMLHttpRequest||u,i.XDomainRequest="withCredentials"in new i.XMLHttpRequest?i.XMLHttpRequest:c.XDomainRequest,function(e,t){for(var r=0;r<e.length;r++)t(e[r])}(["get","put","post","patch","head","delete"],function(e){i["delete"===e?"del":e]=function(t,r,n){return r=o(t,r,n),r.method=e.toUpperCase(),a(r)}})},function(e,t){function r(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var o in r)n.call(r,o)&&(e[o]=r[o])}return e}e.exports=r;var n=Object.prototype.hasOwnProperty}])});